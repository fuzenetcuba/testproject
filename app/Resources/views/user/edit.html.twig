{% extends 'BackendBundle::layout.html.twig' %}

{% block custom_css %}
    {{ parent() }}

    <!-- iCheck Styles -->
    <link rel="stylesheet" href="{{ asset('bundles/backend/css/plugins/iCheck/custom.css') }}"
          type="text/css"/>
    <!-- select2 Styles -->
    <link rel="stylesheet" href="{{ asset('bundles/backend/css/plugins/select2/select2.min.css') }}"
          type="text/css"/>
{% endblock %}

{% block active_users %}active{% endblock %}
{% block page_heading_title %}
    <a class="btn btn-default navbar-btn" href="{{ path('user') }}" style="margin-bottom: 7px;">
        <span class="glyphicon glyphicon-chevron-up"></span>
    </a>
    System User edition
{% endblock %}
{% block page_content %}

    <form class="form-horizontal" action="{{ path('user_update', {'id' : entity.id}) }}"
          method="post" {{ form_enctype(edit_form) }}>

        <div class="form-group">
            <label for="" class="col-md-2 control-label">{{ form_label(edit_form.username) }}</label>

            <div class="col-md-6">
                <p class="form-control-static">{{ entity.username }}</p>
                <div class="hidden">{{ form_widget(edit_form.username, { 'attr': {'class' : 'form-control', 'readonly' : 'true'}}) }}</div>
                {{ form_errors(edit_form.username) }}
            </div>
        </div>
        <div class="hr-line-dashed"></div>
        <div class="form-group{% if(edit_form.firstName.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
            <label for="firstName" class="col-md-2 control-label">{{ form_label(edit_form.firstName) }}</label>

            <div class="col-md-6">
                {{ form_widget(edit_form.firstName, { 'attr': {'class' : 'form-control'}}) }}
                {% if edit_form.firstName.vars['errors']|length > 0 %}
                    <ul class="message">
                        {% for error in edit_form.firstName.vars['errors'] %}
                            <li>{{ error.message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>
        </div>
        <div class="hr-line-dashed"></div>
        <div class="form-group{% if(edit_form.lastName.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
            <label for="lastName" class="col-md-2 control-label">{{ form_label(edit_form.lastName) }}</label>

            <div class="col-md-6">
                {{ form_widget(edit_form.lastName, { 'attr': {'class' : 'form-control'}}) }}
                {% if edit_form.lastName.vars['errors']|length > 0 %}
                    <ul class="message">
                        {% for error in edit_form.lastName.vars['errors'] %}
                            <li>{{ error.message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>
        </div>
        <div class="hr-line-dashed"></div>
        <div class="form-group{% if(edit_form.email.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
            <label for="email" class="col-md-2 control-label">{{ form_label(edit_form.email) }}</label>

            <div class="col-md-6">
                {{ form_widget(edit_form.email, { 'attr': {'class' : 'form-control'}}) }}
                {% if edit_form.email.vars['errors']|length > 0 %}
                    <ul class="message">
                        {% for error in edit_form.email.vars['errors'] %}
                            <li>{{ error.message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>
        </div>
        <div class="hr-line-dashed"></div>

        {% for passwordField in edit_form.password %}

            <div class="form-group{% if(passwordField.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
                <label for="password" class="col-md-2 control-label">{{ form_label(passwordField) }}</label>

                <div class="col-md-6">
                    {{ form_widget(passwordField, { 'attr': {'class' : 'form-control'}}) }}
                    {% if passwordField.vars['errors']|length > 0 %}
                        <ul class="message">
                            {% for error in passwordField.vars['errors'] %}
                                <li>{{ error.message }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>
            </div>
            <div class="hr-line-dashed"></div>
        {% endfor %}
        <div class="form-group{% if(edit_form.phone.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
            <label for="phone" class="col-md-2 control-label">{{ form_label(edit_form.phone) }}</label>

            <div class="col-md-6">
                {{ form_widget(edit_form.phone, { 'attr': {'class' : 'form-control'}}) }}
                {% if edit_form.phone.vars['errors']|length > 0 %}
                    <ul class="message">
                        {% for error in edit_form.phone.vars['errors'] %}
                            <li>{{ error.message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>
        </div>
        <div class="hr-line-dashed"></div>
        <div class="form-group{% if(edit_form.enabled.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
            <label for="enabled" class="col-md-2 control-label">{{ form_label(edit_form.enabled) }}</label>

            <div class="col-md-1">
                <div class="checkbox-inline">
                    {{ form_widget(edit_form.enabled, { 'attr': {'class' : 'form-control i-checks' }}) }}
                    {% if edit_form.enabled.vars['errors']|length > 0 %}
                        <ul class="message">
                            {% for error in edit_form.enabled.vars['errors'] %}
                                <li>{{ error.message }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="hr-line-dashed"></div>
        <div class="form-group{% if(edit_form.roles.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
            <label for="roles" class="col-md-2 control-label">{{ form_label(edit_form.roles) }}</label>

            <div class="col-md-6">
                {% for roleField in edit_form.roles %}
                    <div class="checkbox col-md-6">
                        {{ form_widget(roleField, { 'attr': {'class' : 'i-checks'}}) }}
                        {{ form_label(roleField) }}
                    </div>
                {% endfor %}
                {% if edit_form.roles.vars['errors']|length > 0 %}
                    <ul class="message">
                        {% for error in edit_form.roles.vars['errors'] %}
                            <li>{{ error.message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>
        </div>
        <div class="hr-line-dashed"></div>


        <div class="form-group{% if(edit_form.imageFile.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
            <label for="" class="col-md-2 control-label">{{ form_label(edit_form.imageFile) }}</label>

            <div class="col-md-6">
                {{ form_widget(edit_form.imageFile, { 'attr': {'class' : 'form-control'}}) }}
                {% if edit_form.imageFile.vars['errors']|length > 0 %}
                    <ul class="message">
                        {% for error in edit_form.imageFile.vars['errors'] %}
                            <li>{{ error.message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>
        </div>
        <div class="hr-line-dashed"></div>



        <div class="form-group{% if(edit_form.business.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
            <label for="" class="col-md-2 control-label">{{ form_label(edit_form.business) }}</label>

            <div class="col-md-6">
                {{ form_widget(edit_form.business, { 'attr': {'class' : 'form-control select2-field', 'style' : 'width: 100%'}}) }}
                {% if edit_form.business.vars['errors']|length > 0 %}
                    <ul class="message">
                        {% for error in edit_form.business.vars['errors'] %}
                            <li>{{ error.message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>
        </div>
        <div class="hr-line-dashed"></div>



        <div class="form-group{% if(edit_form.rewards.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
            <label for="" class="col-md-2 control-label">{{ form_label(edit_form.rewards) }}</label>

            <div class="col-md-6">
                {{ form_widget(edit_form.rewards, { 'attr': {'class' : 'form-control select2-field', 'style' : 'width: 100%'}}) }}
                {% if edit_form.rewards.vars['errors']|length > 0 %}
                    <ul class="message">
                        {% for error in edit_form.rewards.vars['errors'] %}
                            <li>{{ error.message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>
        </div>
        <div class="hr-line-dashed"></div>

        <div class="form-group border-top padding-basic-top">
            <div class="col-md-2 text-right">
                <a class="btn btn-success" href="{{ path('user') }}">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                    Back to the list
                </a>
            </div>
            <div class="col-md-10">
                {{ form_widget(edit_form.submit, { 'attr': { 'class' : 'btn btn-primary btn-small', }}) }}
                <a class="btn btn-danger" data-toggle="modal" data-target="#modalDelete">
                    <span class="glyphicon glyphicon-remove"></span>
                    Delete
                </a>
                {{ form(edit_form) }}
            </div>
        </div>
    </form>
    <br/>

    <div class="modal inmodal" id="modalDelete" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content animated bounceInRight">
                <div id="modal-title" class="modal-header red-bg">
                    <button type="button" class="close" data-dismiss="modal"><span
                                aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                    </button>
                    <i class="fa fa-exclamation-triangle modal-icon text-white"></i>
                    <h4 class="modal-title">Atention!!!</h4>
                </div>
                <div id="modal-content" class="modal-body">
                    <strong>Are you sure you want to delete this data?</strong>
                </div>
                <div class="modal-footer">
                    <form action="{{ path('user_delete', { 'id': entity.id }) }}" name="form-delete" method="post">
                        <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
                        <button id="modal-btn" type="submit" class="btn btn-danger" name="user-id" value="{{ entity.id }}">
                            <span class="glyphicon glyphicon-ok"></span> Save changes
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block custom_js %}
    {{ parent() }}

    <!-- iCheck Scripts -->
    <script src="{{ asset('bundles/backend/js/plugins/iCheck/icheck.min.js') }}"
            type="text/javascript"></script>
    <!-- select2 Scripts -->
    <script src="{{ asset('bundles/backend/js/plugins/select2/select2.full.min.js') }}"
            type="text/javascript"></script>
{% endblock %}

{% block inline_js %}

    <script type="text/javascript">

        $(document).ready(function () {
            //  iCheck scripts for checkboxes and radios
            $('.i-checks').iCheck({
                checkboxClass: 'icheckbox_square-green',
                radioClass: 'iradio_square-green',
            });

            //  select2 scripts for batch actions combobox
            $(".select2-field").select2({
                placeholder: "--- Select a value ---"
            });

        });
    </script>

{% endblock %}