{% extends 'BackendBundle::layout.html.twig' %}

{% block custom_css %}
    <link rel="stylesheet" href="{{ asset('bundles/backend/css/plugins/summernote/summernote.css') }}"
          type="text/css"/>
    <link rel="stylesheet" href="{{ asset('bundles/backend/css/plugins/summernote/summernote-bs3.css') }}"
          type="text/css"/>

    {{ parent() }}


    <!-- select2 Styles -->
    <link rel="stylesheet" href="{{ asset('bundles/backend/css/plugins/select2/select2.min.css') }}"
          type="text/css"/>
{% endblock %}

        {% block active_presspost %}active{% endblock %}

        {% block page_heading_title %}
            <a class="btn btn-default navbar-btn" href="{{ path('press') }}"
               style="margin-bottom: 7px;">
                <span class="glyphicon glyphicon-chevron-up"></span>
            </a>
            PressPost creation
        {% endblock %}

        {% block page_content %}

            {{ form_start(form, {'attr': {'class':'form-horizontal', 'novalidate':'novalidate'}}) }}

            <div class="tabs-container">
                <ul class="nav nav-tabs">
                    <li class="{% if app.request.get('_locale') == 'en' %}active{% endif %}"><a
                                href="{{ path(app.request.get('_route'), app.request.get('_route_params')|merge({'_locale' : 'en'})) }}"><i
                                    class="flag flag-icon flag-icon-us"></i> ENGLISH</a></li>
                    <li class="{% if app.request.get('_locale') == 'es' %}active{% endif %}"><a
                                href="{{ path(app.request.get('_route'), app.request.get('_route_params')|merge({'_locale' : 'es'})) }}"><i
                                    class="flag flag-icon flag-icon-es"></i> SPANISH</a></li>
                </ul>
                <div class="tab-content">
                    <div id="tab-1" class="tab-pane active">
                        <div class="panel-body">
                            <div class="form-group{% if(form.title.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
                                <label for="" class="col-md-2 control-label">{{ form_label(form.title) }}</label>

                                <div class="col-md-6">
                                    {{ form_widget(form.title, { 'attr': {'class' : 'form-control'}}) }}
                                    {% if form.title.vars['errors']|length > 0 %}
                                        <ul class="message">
                                            {% for error in form.title.vars['errors'] %}
                                                <li>{{ error.message }}</li>
                                            {% endfor %}
                                        </ul>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>

                            <div class="form-group{% if(form.url.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
                                <label for="" class="col-md-2 control-label">{{ form_label(form.url) }}</label>

                                <div class="col-md-6">
                                    {{ form_widget(form.url, { 'attr': {'class' : 'form-control'}}) }}
                                    {% if form.url.vars['errors']|length > 0 %}
                                        <ul class="message">
                                            {% for error in form.url.vars['errors'] %}
                                                <li>{{ error.message }}</li>
                                            {% endfor %}
                                        </ul>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>

                            <div class="form-group{% if(form.createdOn.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
                                <label class="col-md-2 control-label">{{ form_label(form.createdOn) }}</label>
                                <div class="col-md-6">
                                    <div class="input-group">
                                <span class="input-group-addon">
                                    <span class="fa fa-calendar"></span>
                                </span>
                                        {{ form_widget(form.createdOn, { 'attr': {'class' : 'form-control datepicker'}}) }}
                                        {% if form.createdOn.vars['errors']|length > 0 %}
                                            <ul class="message">
                                                {% for error in form.createdOn.vars['errors'] %}
                                                    <li>{{ error.message }}</li>
                                                {% endfor %}
                                            </ul>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>

                            <div class="form-group{% if(form.author.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
                                <label for="" class="col-md-2 control-label">{{ form_label(form.author) }}</label>

                                <div class="col-md-6">
                                    {{ form_widget(form.author, { 'attr': {'class' : 'form-control'}}) }}
                                    {% if form.author.vars['errors']|length > 0 %}
                                        <ul class="message">
                                            {% for error in form.author.vars['errors'] %}
                                                <li>{{ error.message }}</li>
                                            {% endfor %}
                                        </ul>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>

                            <div class="form-group{% if(form.imageFile.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
                                <label for="" class="col-md-2 control-label">{{ form_label(form.imageFile) }}</label>

                                <div class="col-md-6">
                                    {{ form_widget(form.imageFile, { 'attr': {'class' : 'form-control'}}) }}
                                    {% if form.imageFile.vars['errors']|length > 0 %}
                                        <ul class="message">
                                            {% for error in form.imageFile.vars['errors'] %}
                                                <li>{{ error.message }}</li>
                                            {% endfor %}
                                        </ul>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>


                            <div class="form-group{% if(form.video.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
                                <label for="" class="col-md-2 control-label">{{ form_label(form.video) }}</label>

                                <div class="col-md-6">
                                    {{ form_widget(form.video, { 'attr': {'class' : 'form-control'}}) }}
                                    {% if form.video.vars['errors']|length > 0 %}
                                        <ul class="message">
                                            {% for error in form.video.vars['errors'] %}
                                                <li>{{ error.message }}</li>
                                            {% endfor %}
                                        </ul>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>


                            <div class="mail-text h-200">
                                <div class="form-group{% if(form.text.vars['errors']|length > 0) %} {{ ' has-error' }} {% endif %}">
                                    <label for="" class="col-md-2 control-label">{{ form_label(form.text) }}</label>

                                    <div class="col-md-12">
                                        {% if form.text.vars['errors']|length > 0 %}
                                            <ul class="message">
                                                {% for error in form.text.vars['errors'] %}
                                                    <li>{{ error.message }}</li>
                                                {% endfor %}
                                            </ul>
                                        {% endif %}
                                        {{ form_widget(form.text, { 'attr': {'class' : 'form-control large-height summernote'}}) }}
                                    </div>
                                </div>
                            </div>


                            <div class="form-group">
                                <div class="col-md-2 text-right">
                                    <a class="btn btn-success" href="{{ path('press') }}">
                                        <span class="glyphicon glyphicon-chevron-left"></span>
                                        {{ 'Back to the list' | trans({}, 'generalbackend') }}
                                    </a>
                                </div>
                                <div class="col-md-10">

                                    {{ form_widget(form.submit, { 'attr': { 'class' : 'btn btn-primary btn-small', }}) }}

                                    {{ form(form) }}

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {{ form_end(form) }}

        {% endblock %}

    {% block custom_js %}
        {{ parent() }}


        <!-- select2 Scripts -->
        <script src="{{ asset('bundles/backend/js/plugins/select2/select2.full.min.js') }}"
                type="text/javascript"></script>
        <script src="{{ asset('bundles/backend/js/plugins/summernote/summernote.min.js') }}"
                type="text/javascript"></script>
    {% endblock %}

    {% block inline_js %}
        <script type="text/javascript">

            $(document).ready(function () {
                //  select2 scripts for batch actions combobox
                $(".select2-field").select2({
                    placeholder: "--- Select a value ---"
                });


                $('.summernote').summernote({
                    toolbar: [
                        ['style', ['bold', 'italic', 'underline', 'clear']],
                        ['fontsize', ['fontsize']],
                        ['color', ['color']],
                        ['para', ['ul', 'ol', 'paragraph']],
                        ['insert', ['link', 'table']]
                    ]
                });

                //  datepicker3 script for input datetime and date
                $("form input.datepicker").datepicker({
                    todayBtn: "linked",
                    keyboardNavigation: false,
                    forceParse: false,
                    autoclose: true,
                    format: "yyyy-mm-dd"
                });


                $('form').on('submit', function () {
                    var form = $(this);
                    var textarea = form.find('textarea');
                    var content = $('.note-editable').text()
                    textarea.val(content);

                    if (content == null || content == '' || content == '<p><br></p>') {     // if message content is null
                        $('#flashbag-block').html(
                                '<div class="alert alert-danger fade in">'
                                + '<button class="close" type="button" data-dismiss="alert" aria-hidden="true">×</button>'
                                + '<span class="fa fa-exclamation-triangle"></span>'
                                + '{{ 'You must write the content of press note.' | trans({}, 'press') }}'
                                + '</div>'
                        );

                        return false;
                    }

                    return true;
                })
            });

        </script>
    {% endblock %}
