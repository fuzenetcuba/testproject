{% set current = app.request.attributes.get('_route')|split('_')[0] %}

<div class="navbar-wrapper">
    <nav class="navbar navbar-default navbar-fixed-top {% block navbar_class 'navbar-scroll' %}" role="navigation">
        <div class="container">
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                        aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="{{ path('frontend_homepage') }}">
                    <img src="{{ asset('bundles/frontend/img/plaza_mariachi.png') }}"
                         alt="Plaza Mariachi Music City"/>
                </a>

                {#<a class="navbar-brand" href="#"><i id="logged-in-user">user</i></a>#}
                {#<a class="navbar-brand" href="#" onclick="FB.logout(function(response) {});">#}
                {#<small> Logout</small>#}
                {#</a>#}
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li class="{% if current == 'about' %}active{% endif %}">
                        <a href="#">About</a>
                    </li>
                    <li class="{% if current == 'business' %}active{% endif %}">
                        <a href="{{ path('business_list') }}">Directory</a>
                    </li>
                    <li class="{% if current in ['deals', 'deal'] %}active{% endif %}">
                        <a href="{{ path('deals') }}">Deals</a>
                    </li>
                    <li class="{% if current == 'news' %}active{% endif %}">
                        <a href="#">News & Events</a>
                    </li>
                    <li class="{% if current == 'careers' %}active{% endif %}">
                        <a href="#">Careers</a>
                    </li>
                    <li class="visible-xs">
                        <a href="#">Subscribe</a>
                    </li>
                    <li class="visible-xs">
                        <a href="#">Find Us</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#hours-operation">Hours</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#contact">Contact</a>
                    </li>
                    <li class="dropdown hidden-xs">
                        {% if not app.user %}
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Login/Register</a>
                        {% else %}
                            <a class="dropdown-toggle navbar-avatar" data-toggle="dropdown" href="#">
                                {#{{ app.user.firstName }}#}
                                &nbsp;
                                &nbsp;
                                <img alt="image" class="img-avatar-small img-circle"
                                     src="
                                     {% if((app.user.image) is not null) %}
                                        {{ vich_uploader_asset(app.user, 'imageFile') }}
                                     {% else %}
                                        {{ asset('bundles/backend/images/avatar.jpg') }}
                                     {% endif %}
                                 "/>
                            </a>
                        {% endif %}

                        <div class="dropdown-menu dropdown-header">
                            {% if not app.user %}
                                <div class="ibox-heading">
                                    <h2 class="text-center">Plaza Mariachi</h2>
                                </div>
                                <div class="ibox-content">
                                    <form class="m-t" role="form" action="{{ path('fos_user_security_check') }}"
                                          method="post">
                                        <div class="form-group">
                                            <input class="form-control" placeholder="Username" type="text" id="username"
                                                   name="_username" value="" required="required"
                                                   autofocus="autofocus">
                                        </div>
                                        <div class="form-group">
                                            <input class="form-control" placeholder="Password" type="password"
                                                   id="password"
                                                   name="_password" required="required">
                                        </div>
                                        <button type="submit" name="_submit"
                                                value="{{ 'security.login.submit'|trans({}, 'FOSUserBundle') }}"
                                                class="btn btn-green full-width m-b">{{ 'security.login.submit'|trans({}, 'FOSUserBundle') }}
                                        </button>

                                        <p class="text-center">
                                            <a class="text-green" href="{{ path('fos_user_resetting_request') }}">
                                                <small>Forgot password?</small>
                                            </a>
                                        </p>

                                        <p class="text-muted text-center">
                                            <small>Do not have an account?</small>
                                        </p>

                                        <a class="btn btn-sm btn-blue btn-block"
                                           href="{{ path('fos_user_registration_register') }}">
                                            Create an account
                                        </a>

                                        <input type="hidden" name="_csrf_token"
                                               value="{% render controller('BackendBundle:Default:getCsrfToken') %}"/>
                                        <br/>

                                        <p class="text-muted text-center">
                                            <small>... or login with ...</small>
                                        </p>

                                        <a class="btn btn-block btn-social btn-facebook" href="#" onclick="fb_login();">
                                            <span class="fa fa-facebook pull-left ali"></span> Facebook
                                        </a>
                                    </form>
                                </div>
                            {% else %}
                                <div class="ibox-content">
                                    <a class="logout" href="{{ path('membership') }}">
                                        <i class="fa fa-user"></i> Membership
                                    </a>
                                    <hr/>
                                    <a class="logout" href="{{ path('fos_user_security_logout') }}">
                                        <i class="fa fa-sign-out"></i> Logout
                                    </a>
                                    {% if is_granted('ROLE_ADMIN') %}
                                        <hr/>
                                        <a target="_blank" href="{{ path('backend_homepage') }}">
                                            <i class="fa fa-cog"></i> Admin
                                        </a>
                                    {% endif %}
                                </div>
                            {% endif %}
                        </div>
                    </li>

                    <li class="visible-xs">
                        {% if not app.user %}
                            <a href="{{ path('fos_user_security_login') }}">Login/Register</a>
                        {% else %}
                            <a class="navbar-avatar" href="{{ path("membership") }}">
                                {{ app.user.fullName() }}
                                &nbsp;
                                <img alt="image" class="img-avatar-small img-circle"
                                     src="
                                     {% if((app.user.image) is not null) %}
                                        {{ vich_uploader_asset(app.user, 'imageFile') }}
                                     {% else %}
                                        {{ asset('bundles/backend/images/avatar.jpg') }}
                                     {% endif %}
                                 "/>
                            </a>
                            <a href="{{ path('fos_user_security_logout') }}">
                                <i class="fa fa-sign-out"></i> Logout
                            </a>
                        {% endif %}
                    </li>
                    <li class="visible-xs">
                        {% if is_granted('ROLE_ADMIN') %}
                            <a href="{{ path('backend_homepage') }}">
                                <i class="fa fa-cog"></i> Admin
                            </a>
                        {% endif %}
                    </li>

                    <li class="dropdown language-selector">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            <img class="language-selector-icon"
                                 src="{{ asset("bundles/frontend/img/us_flag_64.jpg") }}"/>
                        </a>
                        <div class="dropdown-menu dropdown-header">
                            <div class="ibox-content">
                                <a href="#">
                                    <img class="language-selector-icon"
                                         src="{{ asset("bundles/frontend/img/us_flag_64.jpg") }}"/>
                                    English
                                </a>
                                <hr/>
                                <a href="#">
                                    <img class="language-selector-icon"
                                         src="{{ asset("bundles/frontend/img/es_flag_64.jpg") }}"/>
                                    Spanish
                                </a>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>